<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Completely Randomised Design</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="crd_Tutorial_files/libs/clipboard/clipboard.min.js"></script>
<script src="crd_Tutorial_files/libs/quarto-html/quarto.js"></script>
<script src="crd_Tutorial_files/libs/quarto-html/popper.min.js"></script>
<script src="crd_Tutorial_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="crd_Tutorial_files/libs/quarto-html/anchor.min.js"></script>
<link href="crd_Tutorial_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="crd_Tutorial_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="crd_Tutorial_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="crd_Tutorial_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="crd_Tutorial_files/libs/bootstrap/bootstrap-ce6282254bc1ab34facc83f4222b8a07.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


<link rel="stylesheet" href="custom.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#definition-of-completely-randomized-design" id="toc-definition-of-completely-randomized-design" class="nav-link active" data-scroll-target="#definition-of-completely-randomized-design">Definition of Completely Randomized Design</a></li>
  <li><a href="#assumptions-of-completely-randomized-design" id="toc-assumptions-of-completely-randomized-design" class="nav-link" data-scroll-target="#assumptions-of-completely-randomized-design">Assumptions of Completely Randomized Design</a></li>
  <li><a href="#implementation-of-completely-randomized-design" id="toc-implementation-of-completely-randomized-design" class="nav-link" data-scroll-target="#implementation-of-completely-randomized-design">Implementation of Completely Randomized Design</a></li>
  <li><a href="#key-characteristics" id="toc-key-characteristics" class="nav-link" data-scroll-target="#key-characteristics">Key Characteristics</a></li>
  <li><a href="#when-to-use-crd" id="toc-when-to-use-crd" class="nav-link" data-scroll-target="#when-to-use-crd">When to Use CRD ?</a></li>
  <li><a href="#not-recommended-when" id="toc-not-recommended-when" class="nav-link" data-scroll-target="#not-recommended-when">Not recommended when:</a></li>
  <li><a href="#advantages-and-disadvantages" id="toc-advantages-and-disadvantages" class="nav-link" data-scroll-target="#advantages-and-disadvantages">Advantages and Disadvantages</a>
  <ul class="collapse">
  <li><a href="#advantages" id="toc-advantages" class="nav-link" data-scroll-target="#advantages">Advantages:</a></li>
  <li><a href="#disadvantages" id="toc-disadvantages" class="nav-link" data-scroll-target="#disadvantages">Disadvantages:</a></li>
  <li><a href="#layout-example" id="toc-layout-example" class="nav-link" data-scroll-target="#layout-example">Layout Example</a></li>
  </ul></li>
  <li><a href="#statistical-model" id="toc-statistical-model" class="nav-link" data-scroll-target="#statistical-model">Statistical Model</a></li>
  <li><a href="#analysis-of-variance-anova" id="toc-analysis-of-variance-anova" class="nav-link" data-scroll-target="#analysis-of-variance-anova">Analysis of Variance (ANOVA)</a></li>
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">Example</a>
  <ul class="collapse">
  <li><a href="#study-context" id="toc-study-context" class="nav-link" data-scroll-target="#study-context">Study Context</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Completely Randomised Design</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In the <strong>1920s</strong>, statistician <strong>Ronald A. Fisher</strong> made significant contributions to the development of the <strong>Completely Randomized Design (CRD)</strong>, which was first used in the early 20th century. Fisher developed this design to enhance agricultural studies, particularly to identify subtle yet significant variations in crop yields under various fertilizer treatments. His novel approach was to <strong>preventing bias</strong> and enabling reliable <strong>statistical analysis</strong> through analysis of variance <strong>(ANOVA)</strong> was to randomly assign treatments to experimental units (like land plots). In order to prevent bias and enable reliable statistical analysis using analysis of variance (ANOVA), he invented the practice of randomly allocating treatments to experimental units (such as land plots).</p>
<p>In this design, <strong>experimental units</strong> are randomly assigned to <strong>treatments</strong> without any systematic bias, ensuring that every unit has an equal probability of receiving any given treatment. This random assignment helps counter potential biases and addresses the inherent variability among experimental units, making comparisons between treatments impartial. In order to account for <strong>natural variation</strong> in soil and environment, the first famous instances involved agricultural field trials in which adjacent plots were randomly assigned to different crop kinds or fertilizer treatments. <strong>Agricultural field trials</strong> were the first well-known instances, in which adjacent plots were randomly assigned to different crop varieties or fertilizer treatments to account for inherent soil and environmental variance.</p>
<p>Although <strong>CRD</strong> is generally not advised for heterogeneous settings, it is especially appropriate when the experimental material is <strong>homogeneous</strong>, as in laboratory or greenhouse investigations. Due to its ease of use and efficiency, CRD has established itself as a key instrument in experimental statistics and is still essential in domains including industrial engineering, quality control analysis, medicine, and agriculture.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
This design is used to examine the effects of a single primary element without considering additional bothersome aspects.
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<section id="definition-of-completely-randomized-design" class="level2">
<h2 class="anchored" data-anchor-id="definition-of-completely-randomized-design">Definition of Completely Randomized Design</h2>
<p>Experiments using the <strong>Completely Randomized Design (CRD)</strong> are set up in which experimental units receive treatments entirely at random. Accordingly, each unit has an equal probability of getting any kind of care. This prevents bias and ensures that the groups are fairly comparable. Therefore, if changes in results are observed, we can be sure that they are caused by the therapies and not by other unidentified causes.</p>
</section>
<section id="assumptions-of-completely-randomized-design" class="level1">
<h1>Assumptions of Completely Randomized Design</h1>
<p>In order to guarantee the <strong>validity</strong> and <strong>dependability</strong> of experimental outcomes, CRD (Completely Randomized Design) is predicated on a number of essential assumptions. Maintaining these fundamental parameters throughout the experiment is <strong>crucial</strong> for the integrity of statistical analysis, particularly when employing <strong>ANOVA</strong>.</p>
<p><strong>Independence</strong> : Independence in experimental design refers to the fact that the <strong>outcome</strong> (response) of one experimental unit is not affected by or connected to the outcome of another unit. Because it gives us confidence that every unit offers a distinct and unaffected piece of information regarding the process or treatment under study, this is a fundamental premise of the <strong>majority</strong> of statistical tests.</p>
<p><strong>Random Assignment</strong> : In experimental design, <strong>randomization</strong> is the process of allocating treatments to experimental units at random, ensuring that each unit has an equal chance of receiving any given treatment. This procedure balances <strong>known</strong> and <strong>unknown</strong> factors across groups, removing selection bias and guaranteeing fairness. By doing this, the groups are initially made comparable, and any variations in results can be ascribed to the treatments rather than underlying differences. Random number tables, computer algorithms, and other chance techniques are frequently used for randomization.</p>
<p><strong>Homogeneity of Variance</strong> : Also referred to as homoscedasticity, the variance of mistakes should be the same for every group or treatment</p>
<p><strong>Normality</strong> : Each treatment’s residuals or errors should have a normal distribution. For ANOVA results to be valid, this is necessary</p>
<p><strong>Additivity</strong> : There is no interaction between unaccounted for factors; the effects in the model are additive. This indicates that the overall mean, treatment effect, and random error add up to the observed result</p>
</section>
<section id="implementation-of-completely-randomized-design" class="level1">
<h1>Implementation of Completely Randomized Design</h1>
<p>Let us breakdown the essential steps involved in executing a <strong>Completely Randomized Design (CRD)</strong> and elucidate the significance of each phase for an effective experiment.</p>
<ol type="1">
<li><strong>Define Your Treatments</strong> :</li>
</ol>
<p>Determining exactly what you wish to test is the <strong>first stage</strong> in designing an experiment. Treatments are the many conditions or interventions that you wish to compare.</p>
<p><strong>Example</strong> :</p>
<ul>
<li><p>If you are testing plant growth, your treatments could be different fertilizer types: Fertilizer A, Fertilizer B, and Fertilizer C.</p></li>
<li><p>In a microbiology experiment, treatments might be different probiotic cultures applied to the samples.</p></li>
</ul>
<p><strong>Why this is important ?</strong> :</p>
<ul>
<li><p>Each treatment must be distinct and well-defined so that you know exactly what is being applied to each experimental unit</p></li>
<li><p>If treatments are unclear or overlapping, it becomes impossible to tell which one is causing any observed effect</p></li>
<li><p>Clear definitions ensure that your experiment produces meaningful and reliable results</p></li>
</ul>
<p><strong>Tip for beginners</strong> :</p>
<ul>
<li><p>Write down a list of all treatments before starting the experiment</p></li>
<li><p>Make sure each treatment can be replicated consistently throughout your study</p></li>
</ul>
<ol start="2" type="1">
<li><strong>Select Experimental Units</strong> :</li>
</ol>
<p>Once you know your treatments, the next step is to choose the experimental units - the subjects, plots, or samples that will receive the treatments.</p>
<p><strong>Key point</strong> : Try to make your units as similar (homogeneous) as possible.</p>
<p><strong>Examples</strong> :</p>
<ul>
<li><p>In a plant experiment, choose plots with similar soil type, sunlight, and water availability.</p></li>
<li><p>In animal studies, select animals of the same breed, age, and health status.</p></li>
</ul>
<p><strong>Why this matters ?</strong> :</p>
<ul>
<li><p>If your units differ in ways unrelated to the treatments, it’s hard to know whether the differences in results are due to the treatment or the natural differences among the units.</p></li>
<li><p>Using homogeneous units helps ensure that any observed effects are truly caused by the treatments.</p></li>
</ul>
<p><strong>Tip for beginners</strong> :</p>
<ul>
<li><p>Before starting, list the key characteristics your units should have.</p></li>
<li><p>Try to minimize variations that are not part of your experiment.</p></li>
</ul>
<ol start="3" type="1">
<li><strong>Random Assignment</strong>:</li>
</ol>
<p>After selecting your experimental units, the next step is to assign treatments randomly. This ensures that each unit has an equal chance of receiving any treatment.</p>
<p><strong>Common ways to randomize</strong>:</p>
<ul>
<li><p>Random number tables - Use a pre-made table of random numbers to assign treatments.</p></li>
<li><p>Statistical software - For example, in R you can use sample(); in Excel, use RAND() or RANDBETWEEN().</p></li>
<li><p>Drawing lots - Write treatment names on slips of paper and draw them for each unit.</p></li>
</ul>
<p><strong>Why this is important ?</strong>:</p>
<ul>
<li><p>Randomization removes selection bias and helps balance out unknown or hidden variables across treatment groups.</p></li>
<li><p>It ensures that differences in outcomes can be attributed to the treatments, not to pre-existing differences among units.</p></li>
</ul>
<p><strong>Tip for beginners</strong>:</p>
<ul>
<li><p>Always document your randomization method so others can reproduce your experiment.</p></li>
<li><p>Avoid “manual” assignments based on convenience - these can unintentionally introduce bias.</p></li>
</ul>
<ol start="4" type="1">
<li><strong>Conduct the Experiment</strong>:</li>
</ol>
<ul>
<li>Once treatments are randomly assigned, it’s time to carry out the experiment.</li>
</ul>
<p><strong>Key points</strong>:</p>
<ul>
<li><p>Apply each treatment exactly as planned to the units it was assigned to.</p></li>
<li><p>Keep all other conditions the same across all units - such as light, temperature, watering, or handling - so that only the treatment varies.</p></li>
<li><p>Collect data carefully and systematically. Record measurements in a consistent way for every unit.</p></li>
</ul>
<p><strong>Why this matters ?</strong>:</p>
<ul>
<li><p>Consistency ensures that any differences you observe are truly caused by the treatments, not by uncontrolled factors.</p></li>
<li><p>Accurate and systematic data collection makes your results reliable and reproducible.</p></li>
</ul>
<p><strong>Tip for beginners</strong>:</p>
<p>Prepare a data recording sheet or table before starting. Double-check that measurements are taken at the same time and under the same conditions for all units.</p>
<ol start="5" type="1">
<li><strong>Analyze the Data</strong>:</li>
</ol>
<p>After you have collected all your data, the next step is to analyze it using statistical methods.</p>
<p><strong>How to do it</strong>:</p>
<ul>
<li>A common technique is Analysis of Variance (ANOVA), which compares the average outcomes of all treatment groups. ANOVA helps you decide whether the differences you see between treatments are statistically significant or just due to random variation.</li>
</ul>
<p><strong>Why this matters ?</strong>:</p>
<ul>
<li><p>Experimental units naturally vary, even under identical conditions.</p></li>
<li><p>ANOVA accounts for this random variation and tells you whether the treatment itself caused the observed differences.</p></li>
<li><p>This ensures that your conclusions about which treatment is better are scientifically valid.</p></li>
</ul>
<p><strong>Tip for beginners</strong>:</p>
<ul>
<li><p>Make sure your data is organized in a table with treatments and corresponding measurements.</p></li>
<li><p>Use statistical software (like R, Excel, or SPSS) to perform ANOVA efficiently and accurately.</p></li>
</ul>
</section>
<section id="key-characteristics" class="level1">
<h1>Key Characteristics</h1>
<p>• <strong>Random allocation</strong>: Treatments are randomly assigned to experimental units</p>
<p>• <strong>Homogeneous conditions</strong>: Best suited when experimental units are relatively uniform</p>
<p>• <strong>Flexibility</strong>: Number of replications can vary between treatments</p>
<p>• <strong>Simple analysis</strong>: Uses one-way ANOVA for statistical analysis</p>
</section>
<section id="when-to-use-crd" class="level1">
<h1>When to Use CRD ?</h1>
<p><strong>Appropriate situations</strong>:</p>
<p>• Laboratory experiments with controlled conditions</p>
<p>• Greenhouse experiments with uniform environmental conditions</p>
<p>• Animal feeding trials where animals are relatively homogeneous</p>
<p>• Pot experiments with uniform soil and environmental conditions</p>
</section>
<section id="not-recommended-when" class="level1">
<h1>Not recommended when:</h1>
<p>• Experimental area shows significant variation (use RCBD instead)</p>
<p>• There’s a known gradient in the experimental material</p>
<p>• Field experiments with heterogeneous soil conditions</p>
</section>
<section id="advantages-and-disadvantages" class="level1">
<h1>Advantages and Disadvantages</h1>
<section id="advantages" class="level2">
<h2 class="anchored" data-anchor-id="advantages">Advantages:</h2>
<p>• Simple to design and analyze</p>
<p>• Flexible in number of treatments and replications</p>
<p>• Maximum degrees of freedom for error term</p>
<p>• Missing data doesn’t complicate analysis significantly</p>
<p>• Easy to understand and implement</p>
</section>
<section id="disadvantages" class="level2">
<h2 class="anchored" data-anchor-id="disadvantages">Disadvantages:</h2>
<p>• Requires homogeneous experimental conditions</p>
<p>• Less precise than blocking designs when heterogeneity exists</p>
<p>• Can lead to larger experimental error if conditions are not uniform</p>
</section>
<section id="layout-example" class="level2">
<h2 class="anchored" data-anchor-id="layout-example">Layout Example</h2>
<p>Suppose we’re testing 4 fertilizer treatments (A, B, C, D) with 5 replications each (20 experimental units total):</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">CRD Layout Preview</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<iframe src="crd_colored_layout.html" width="100%" height="500px" style="border:none;">
</iframe>
</div>
</div>
</div>
</section>
</section>
<section id="statistical-model" class="level1">
<h1>Statistical Model</h1>
<p>The linear model for <strong>CRD</strong> is:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>Yᵢⱼ <span class="ot">=</span> μ <span class="sc">+</span> τᵢ <span class="sc">+</span> εᵢⱼ  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Where</strong>:</p>
<p>• <strong>Yᵢⱼ</strong> = observation for the jth unit receiving the ith treatment</p>
<p>• <strong>μ</strong> = overall mean</p>
<p>• <strong>τᵢ</strong> = effect of the ith treatment</p>
<p>• <strong>εᵢⱼ</strong> = random error (assumed to be normally distributed with mean 0 and variance σ²)</p>
<p>• <strong>i</strong> = 1, 2, …, t (treatments)</p>
<p>• <strong>j</strong> = 1, 2, …, r (replications)</p>
</section>
<section id="analysis-of-variance-anova" class="level1">
<h1>Analysis of Variance (ANOVA)</h1>
<p>ANOVA Table Structure:</p>
</section>
<section id="example" class="level1">
<h1>Example</h1>
<p>Let’s explore some practical situations in agricultural research where the Completely Randomised Design, also known as the CRD, is applied.</p>
<section id="study-context" class="level2">
<h2 class="anchored" data-anchor-id="study-context">Study Context</h2>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>